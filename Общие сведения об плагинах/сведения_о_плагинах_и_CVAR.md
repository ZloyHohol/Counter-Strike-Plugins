# Полный обзор плагинов SourceMod

Этот документ содержит подробное описание функциональности плагинов, их переменных (CVAR), а также анализ того, как настройки могут влиять на их поведение.

---

## Ammunition_control/AmmoControl_v2.sp

### Принцип работы
Этот плагин позволяет администраторам контролировать максимальный боезапас для различных видов оружия и гранат. Он также включает функцию изменения механики перезарядки для дробовиков M3 и XM1014 на магазинную.

### CVAR'ы и их влияние

*   `sm_ammo_338mag_max` (стандартное значение: `60`): Максимальный боезапас для AWP.
*   `sm_ammo_357sig_max` (стандартное значение: `104`): Максимальный боезапас для P228.
*   `sm_ammo_45acp_max` (стандартное значение: `200`): Максимальный боезапас для UMP45, Mac10.
*   `sm_ammo_50AE_max` (стандартное значение: `70`): Максимальный боезапас для Desert Eagle.
*   `sm_ammo_556mm_box_max` (стандартное значение: `400`): Максимальный боезапас для M249.
*   `sm_ammo_556mm_max` (стандартное значение: `180`): Максимальный боезапас для M4A1, Galil, Famas, SG552.
*   `sm_ammo_57mm_max` (стандартное значение: `200`): Максимальный боезапас для P90.
*   `sm_ammo_762mm_max` (стандартное значение: `180`): Максимальный боезапас для AK47, G3SG1.
*   `sm_ammo_9mm_max` (стандартное значение: `240`): Максимальный боезапас для Glock, USP, MP5, TMP.
*   `sm_ammo_buckshot_max` (стандартное значение: `64`): Максимальный боезапас для M3, XM1014.
*   `sm_ammo_flashbang_max` (стандартное значение: `4`): Максимальный боезапас для светошумовых гранат.
*   `sm_ammo_hegrenade_max` (стандартное значение: `4`): Максимальный боезапас для осколочных гранат.
*   `sm_ammo_smokegrenade_max` (стандартное значение: `4`): Максимальный боезапас для дымовых гранат.
*   `sm_weapon_m3_magazine_reload` (стандартное значение: `1`): Включить магазинную перезарядку для M3 (1 - да, 0 - нет).
*   `sm_weapon_m3_clip` (стандартное значение: `8`): Размер магазина для M3.
*   `sm_weapon_m3_reload_time` (стандартное значение: `5.7`): Время перезарядки магазина M3 в секундах.
*   `sm_weapon_xm1014_magazine_reload` (стандартное значение: `1`): Включить магазинную перезарядку для XM1014 (1 - да, 0 - нет).
*   `sm_weapon_xm1014_clip` (стандартное значение: `20`): Размер магазина для XM1014.
*   `sm_weapon_xm1014_reload_time` (стандартное значение: `5.7`): Время перезарядки магазина XM1014 в секундах.

*   **Как может "сломать"**: 
    *   Установка экстремальных значений для `_clip` и `_reload_time` может сделать дробовики бесполезными или слишком мощными. Например, очень большое значение `_reload_time` заставит дробовик перезаряжаться очень долго, в то время как очень большой размер `_clip` даст ему огромное количество патронов до необходимости перезарядки.
    *   **Особенность движка**: У дробовиков M3/XM1014 в коде игры "зашит" стандартный боезапас в 8/7 патронов. Если в `sm_weapon_m3_clip` или `sm_weapon_xm1014_clip` выставить значение, отличающееся от стандартного, может возникнуть сбой. После "магазинной" перезарядки до указанного в плагине количества патронов, если снова нажать на перезарядку, дробовик может начать дозаряжать в себя весь остальной боезапас. Это связано с "костылями" в логике самой игры, и бороться с этим без серьезного вмешательства в движок (например, через DHooks) практически бесполезно.

---

## Death Informer/DeathInformer.sp

### Принцип работы
Этот плагин отображает подробную информацию игроку, когда его убивают. Он показывает оставшееся здоровье и броню атакующего, а также историю последних 5 попаданий от этого атакующего в настраиваемом временном окне.

### CVAR'ы и их влияние

*   `sm_deathinformer_history_time` (стандартное значение: `15.0`): Как долго (в секундах) отслеживать историю урона от атакующего перед смертью. Минимальное значение 5.0, максимальное 50.0.

*   **Как может "сломать"**: Если установить это значение слишком низким (например, `5.0`), информация о уроне может быть неполной, если между попаданиями были большие промежутки времени. Если установить слишком высоким (например, `50.0`), в истории могут отображаться "старые" попадания, не имеющие отношения к последней перестрелке.

---

## Dragon Breath Bullet for Shotguns (M3+XM1014)/addons/sourcemod/scripting/Dragon Breath Bullet.sp

### Принцип работы
Этот плагин заставляет дробовики M3 и XM1014 стрелять патронами "дыхание дракона", которые создают небольшой огненный эффект при попадании, способный поджечь игроков.

### CVAR'ы и их влияние

*   `sm_dragonguns_enable` (стандартное значение: `1`): Включить/выключить плагин.
*   `sm_dragonguns_guns` (стандартное значение: `xm1014 m3`): Какие оружия стреляют взрывами (разделенные пробелами).
*   `sm_dragonguns_damage` (стандартное значение: `5.0`): Урон от огня при касании, в секунду (0.0 = нет урона).
*   `sm_dragonguns_ignite_time` (стандартное значение: `4.0`): Время в секундах, на которое поджигается игрок.
*   `sm_dragonguns_playsound` (стандартное значение: `1`): Включить/выключить звук при поджоге игрока.

*   **Как может "сломать"**: Если в `sm_dragonguns_guns` указать оружие, не являющееся дробовиком, это может привести к неожиданному поведению. Например, у автоматического оружия каждый выстрел будет создавать огненный эффект, что может вызвать сильные лаги на сервере и визуальный хаос.

---

## Gravity Switcher/GravitySwitcher.sp

### Принцип работы
Этот плагин позволяет администратору изменять гравитацию сервера, что влияет на всех игроков. Он предоставляет меню для включения/отключения низкой гравитации и установки множителя.

### CVAR'ы и их влияние

*   `sm_gravity_enabled` (стандартное значение: `0`): Включен ли режим низкой гравитации.
*   `sm_gravity_multiplier` (стандартное значение: `0.5`): Множитель гравитации.

*   **Как может "сломать"**: Установка `sm_gravity_multiplier` на `0.0` приведет к полной невесомости, и игроки могут улететь за пределы карты. Слишком высокое значение (например, `2.0`) сделает прыжки почти невозможными.

---

## HUD_Damage/ShowDamage.sp и HUD_Damage/ShowDamage_MultiColour.sp

### Принцип работы
Эти плагины отображают урон, нанесенный врагу, в HUD. `ShowDamage_MultiColour.sp` — это обновленная версия, которая показывает урон разными цветами в зависимости от команды жертвы. Оба предлагают разные стили отображения.

### CVAR'ы и их влияние

У этих плагинов нет CVAR'ов для настройки. Вместо этого они используют cookie для хранения предпочтений игроков по стилю отображения.

---

## Immortal Hostages/addons/sourcemod/scripting/ImmortalHostages_fixed.sp

### Принцип работы
Этот плагин делает заложников неуязвимыми для урона, с различными режимами, позволяющими наносить урон только террористам, только контртеррористам или никому.

### CVAR'ы и их влияние

*   `sm_hostages_mode` (стандартное значение: `3`): Режим урона по заложникам:
    *   `0` = normal (заложники получают урон как обычно)
    *   `1` = vulnerable_to_T (только террористы могут наносить урон заложникам)
    *   `2` = vulnerable_to_CT (только контр-террористы могут наносить урон заложникам)
    *   `3` = invulnerable (заложники не получают урон ни от какого источника)
*   `sm_hostages_debug` (стандартное значение: `0`): Включить отладочные сообщения (0/1).

*   **Как может "сломать"**: Если `sm_hostages_mode` установлен в `1` или `2`, это может нарушить баланс на картах с заложниками, так как одна из команд не сможет случайно (или намеренно) убить заложников.

---

## PRD/PlayerRewardAndDiscipline.sp

### Принцип работы
Это сложный плагин с несколькими функциями:
*   **Награды MVP**: система вознаграждения MVP раунда деньгами на основе голосов его команды.
*   **Наказание за убийство товарищей по команде**: система наказания за убийство товарищей по команде с возможностью автоматического наказания или голосования жертвы. Она включает систему "прощения" за "справедливые" убийства и "взаимную агрессию".
*   **Анти-кемпер**: система для обнаружения и наказания кемперов путем создания на них эффекта маяка.
*   **Правила**: система для отображения правил сервера игрокам в начале раундов.

### CVAR'ы и их влияние

*   `sm_prd_mvp_enable` (стандартное значение: `1`): Включить/выключить систему вознаграждения MVP.
*   `sm_prd_mvp_amount` (стандартное значение: `1000`): Сумма денег за голос за MVP.
*   `sm_prd_mvp_max_reward` (стандартное значение: `16000`): Максимальная награда MVP.
*   `sm_prd_teamkill_enable` (стандартное значение: `1`): Включить/выключить систему наказания за убийство товарищей по команде.
*   `sm_teamkill_punish_mode` (стандартное значение: `2`): 0=выкл, 1=авто-наказание, 2=голосование жертвы.
*   `sm_teamkill_forgive_threshold` (стандартное значение: `2`): Сколько убийств товарищей по команде необходимо, чтобы это считалось "справедливостью".
*   `sm_teamdamage_mutual_threshold` (стандартное значение: `25`): Урон для взаимной агрессии.
*   `sm_prd_bot_punishment` (стандартное значение: `0`): Включить/выключить наказания для ботов.
*   `sm_prd_anticamper_enable` (стандартное значение: `1`): Включить/выключить систему анти-кемпер.
*   `sm_anticamper_time` (стандартное значение: `10.0`): Время (сек), по истечении которого игрок считается кемпером.
*   `sm_prd_player_rules_file` (стандартное значение: `configs/prd_rules_players.txt`): Файл с правилами для игроков.
*   `sm_prd_admin_rules_file` (стандартное значение: `configs/prd_rules_admins.txt`): Файл с правилами для администраторов.
*   `sm_prd_rules_interval` (стандартное значение: `1`): Сколько раундов ждать перед показом следующего правила.
*   `sm_prd_punishments_file` (стандартное значение: `configs/prd_punishments.cfg`): Файл с наказаниями за убийство товарищей по команде.

*   **Как может "сломать"**: Неправильная настройка `sm_teamkill_punish_mode` и `sm_teamkill_forgive_threshold` может привести к несправедливым наказаниям или, наоборот, к безнаказанности за тимкиллы. Например, если `sm_teamkill_punish_mode` равен `1` (авто-наказание), а `sm_teamkill_forgive_threshold` слишком низкий, игроки могут быть наказаны за случайные тимкиллы.

---

## Rule_Health&Armour/sourcemod/scripting/Rule_Health+Armor.sp

### Принцип работы
Этот плагин позволяет администраторам сервера настраивать индивидуальные значения здоровья и брони для игроков в зависимости от их флагов администратора. Он также включает настраиваемые функции бессмертия и отдельные настройки для ботов. Управление плагином осуществляется через админ-меню (`sm_admin` -> `Команды для игроков` -> `RHA Settings`).

### CVAR'ы и их влияние

*   `sm_rha_enabled` (стандартное значение: `1`): Главный переключатель плагина. `1` = Вкл, `0` = Выкл.
*   `sm_rha_admin_immortality_mode` (стандартное значение: `0`): Устанавливает глобальный режим бессмертия для администраторов (0: Выключен, 1: Неуязвимость).
*   `sm_rha_enable_logging` (стандартное значение: `0`): Включить/выключить логирование действий плагина.

### Конфигурация (`addons/sourcemod/configs/RHA_humans.cfg` и `RHA_bots.cfg`)

Плагин использует два файла конфигурации в формате KeyValues:
1.  **`RHA_humans.cfg`**: для игроков-людей.
2.  **`RHA_bots.cfg`**: для ботов.

Вы можете определять группы с разными флагами доступа. Игроки будут отнесены к группе с наибольшим количеством совпадающих флагов.

**Пример структуры для `RHA_humans.cfg`:**
```
"Human-gamers"
{
    "Guest"
    {
        "Flags"         ""
        "Team_T"
        {
            "health"        "100"
            "armor"         "0"
        }
        // ... и так далее
    }
    "Admin_z"
    {
        "Flags"                 "z"
        "CanUseImmortality"     "1"
        "Team_T"
        {
            "health"        "120"
            "armor"         "100"
        }
        // ... и так далее
    }
}
```

*   **`Flags`**: Набор флагов администратора. Пустая строка `""` для гостей.
*   **`CanUseImmortality`**: Если `"1"`, игроки этой группы могут использовать меню RHA и режим бессмертия.
*   **`health` / `armor`**: Значения здоровья и брони.

*   **Как может "сломать"**:
    *   Если `sm_rha_admin_immortality_mode` установлен в `1`, администраторы, у которых есть право `CanUseImmortality`, станут неуязвимыми, что может полностью нарушить игровой баланс. Важно убедиться, что эта функция используется только в административных целях, а не во время обычной игры.
    *   **Ограничение HUD движка**: Стандартный HUD в Counter-Strike: Source некорректно отображает значения брони выше 100. Например, 200 единиц брони могут отображаться как "22", а 175 — как "47". Это чисто визуальный баг движка, и плагин при этом начисляет корректное количество брони. Другие плагины, показывающие информацию при убийстве, будут видеть правильное значение.

---

## SBC_V3/SmokeBombCombo-V3.5.sp

### Принцип работы
Этот плагин делает дымовые гранаты токсичными, нанося урон с течением времени игрокам, находящимся в дыму. Он настраиваемый, с опциями для количества урона, урона по своим и цвета дыма.

### CVAR'ы и их влияние

*   `sm_sbc_enabled` (стандартное значение: `1`): Включить/выключить плагин.
*   `sm_sbc_damage_enabled` (стандартное значение: `1`): Включить урон дымом.
*   `sm_sbc_damage_amount` (стандартное значение: `15`): Урон за тик.
*   `sm_sbc_damage_interval` (стандартное значение: `1.0`): Интервал урона (сек).
*   `sm_sbc_teammate_damage` (стандартное значение: `0`): Урон по своим (0/1), игнорирует `mp_friendlyfire` при 1.
*   `sm_sbc_color_t` (стандартное значение: `255 0 0`): Цвет дыма для T (R G B).
*   `sm_sbc_color_ct` (стандартное значение: `0 0 255`): Цвет дыма для CT (R G B).
*   `sm_sbc_colormode` (стандартное значение: `0`): 0=командные цвета, 1=переопределение.
*   `sm_sbc_override_color` (стандартное значение: `0 0 0`): Цвет переопределения (R G B).

*   **Как может "сломать"**: Если `sm_sbc_teammate_damage` установлен в `1`, дымовые гранаты будут наносить урон товарищам по команде, что может привести к хаосу и случайным убийствам. Это может быть особенно проблематично на маленьких картах.

---

## ShowMySteamID/scripting/ShowMySteamID.sp

### Принцип работы
Этот плагин для SourceMod позволяет игрокам получить свой SteamID, введя в чате одну из команд: `!mysteamid`, `/mysteamid`, `!steamid` или `/steamid`. SteamID отображается в виде личного сообщения, видимого только запросившему игроку. Плагин поддерживает локализацию и скомпилирован для 32-битных и 64-битных архитектур сервера.

### CVAR'ы и их влияние

У этого плагина нет CVAR'ов.

---

## SkinChooser 5.5 CS-Source/addons/sourcemod/scripting/SkinChooser-v55.sp

### Принцип работы
Эта версия плагина (v5.5.1) является значительно переработанной и исправленной версией, позволяющей игрокам выбирать модели (скины). Ключевые улучшения включают полную переработку структуры конфигурации, автоматическое определение и добавление в список загрузки всех необходимых файлов модели, а также исправление ошибок, приводивших к "ERROR" моделям. Плагин поддерживает разделение моделей по командам, ограничение доступа по флагам администратора и принудительную установку скинов.

### CVAR'ы и их влияние

*   `sm_skinchooser_enabled` (стандартное значение: `1`): Включить/выключить плагин.
*   `sm_skinchooser_mapbased` (стандартное значение: `0`): Использовать файлы выбора моделей для каждой карты отдельно (1) или один общий (0).
*   `sm_skinchooser_adminonly` (стандартное значение: `0`): Сделать меню доступным только для администраторов.
*   `sm_skinchooser_closemenutimer` (стандартное значение: `30`): Через сколько секунд автоматически закрывать меню.
*   `sm_skinchooser_autodisplay` (стандартное значение: `1`): Автоматически показывать меню при входе в команду.
*   `sm_skinchooser_displaytimer` (стандартное значение: `0`): Использовать задержку перед показом меню.
*   `sm_skinchooser_menustarttime` (стандартное значение: `5.0`): Задержка в секундах перед автоматическим показом меню.
*   `sm_skinchooser_forceplayerskin` (стандартное значение: `0`): Принудительно устанавливать скины обычным игрокам.
*   `sm_skinchooser_forceplayerskintimer` (стандартное значение: `0.3`): Задержка перед принудительной установкой скина.
*   `sm_skinchooser_forceplayerskintimer_enabled` (стандартное значение: `0`): Использовать таймер для принудительной установки.
*   `sm_skinchooser_skinadmin` (стандартное значение: `0`): Принудительно устанавливать скины администраторам.
*   `sm_skinchooser_skinadmintimer` (стандартное значение: `0.3`): Задержка перед принудительной установкой скина админу.
*   `sm_skinchooser_skinadmintimer_enabled` (стандартное значение: `0`): Использовать таймер для админов.
*   `sm_skinchooser_skinbots` (стандартное значение: `0`): Принудительно устанавливать скины ботам.
*   `sm_skinchooser_savechoice` (стандартное значение: `1`): Сохранять выбор игроков в файл (1 = да, 0 = нет).
*   `sm_skinchooser_loadchoice` (стандартное значение: `1`): Загружать сохраненный выбор игроков (1 = да, 0 = нет).

*   **Как может "сломать"**: Как вы и упомянули, если `sm_skinchooser_savechoice` и `sm_skinchooser_loadchoice` установлены в `0`, плагин не будет сохранять и загружать выбор игроков. Это означает, что при каждом возрождении скин игрока будет сбрасываться на стандартный, и ему придется выбирать его заново. Это не баг, а ожидаемое поведение при таких настройках. Это может быть полезно, если вы хотите, чтобы игроки каждый раз выбирали скин, или если вы хотите избежать проблем с сохранением данных.

---

## SoundManifest/SoundManifest-v3.sp

### Принцип работы
SM_SoundManifest — это единый, современный плагин для управления всеми звуковыми событиями на сервере, заменяющий собой и `Quake Sounds`, и `Welcome Sound`. Он позволяет проигрывать звуки на различные игровые события (убийства, серии, хедшоты, вход игрока) и дает возможность как администратору гибко настраивать эти звуки через файл `configs/SoundManifest_Sounds.ini`, так и игрокам отключать их для себя через меню (`!soundmanifest`).

### CVAR'ы и их влияние

*   `sm_soundmanifest_enabled` (стандартное значение: `1`): 0 = выключить плагин, 1 = включить.
*   `sm_soundmanifest_join_delay` (стандартное значение: `3.0`): Задержка в секундах перед воспроизведением приветственного звука.
*   `sm_soundmanifest_join_audience` (стандартное значение: `0`): Кто слышит приветственный звук: 0 = только присоединившийся, 1 = все.
*   `sm_soundmanifest_join_interval` (стандартное значение: `10.0`): Минимальный интервал в секундах между воспроизведением приветственных звуков.
*   `sm_soundmanifest_default_setting` (стандартное значение: `1`): Должны ли звуки быть включены по умолчанию для новых игроков? 1 = да, 0 = нет.
*   `sm_soundmanifest_justicekill_threshold` (стандартное значение: `2`): Количество убийств товарищей по команде, которое должна совершить жертва, чтобы сработало событие JusticeKill.
*   `sm_soundmanifest_combokill_time` (стандартное значение: `4.0`): Время в секундах для объединения убийств в комбо.
*   `sm_soundmanifest_quadkill_threshold` (стандартное значение: `4`): Количество убийств для QuadKill.
*   `sm_soundmanifest_epicstreak_threshold` (стандартное значение: `5`): Количество убийств для эпической серии (MultiKill и т.д.).
*   `sm_soundmanifest_cooldown_interval` (стандартное значение: `2.0`): Минимальный интервал в секундах между повторениями одного и того же звука.

*   **Как может "сломать"**:
    *   Если `sm_soundmanifest_cooldown_interval` установлен на `0.0`, звуки могут воспроизводиться слишком часто, создавая звуковой спам. Если `sm_soundmanifest_join_interval` установлен на `0.0`, приветственные звуки будут воспроизводиться для каждого присоединившегося игрока без задержки, что также может привести к спаму.
    *   **Известная проблема**: В настоящее время плагин имеет баг, из-за которого объявления о сериях убийств (например, "MultiKill") работают только в первом раунде. В последующих раундах эта функция перестает работать.
